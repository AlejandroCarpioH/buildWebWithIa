import{v as E,e as w,s as S}from"./handleMessageError-8a94c122.js";const R="modulepreload",_=function(e){return"/"+e},H={},C=function(s,n,l){if(!n||n.length===0)return s();const c=document.getElementsByTagName("link");return Promise.all(n.map(t=>{if(t=_(t),t in H)return;H[t]=!0;const o=t.endsWith(".css"),h=o?'[rel="stylesheet"]':"";if(!!l)for(let i=c.length-1;i>=0;i--){const p=c[i];if(p.href===t&&(!o||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${t}"]${h}`))return;const r=document.createElement("link");if(r.rel=o?"stylesheet":R,o||(r.as="script",r.crossOrigin=""),r.href=t,document.head.appendChild(r),o)return new Promise((i,p)=>{r.addEventListener("load",i),r.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${t}`)))})})).then(()=>s()).catch(t=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=t,window.dispatchEvent(o),!o.defaultPrevented)throw t})},P=document.querySelector("iframe");function k(e){localStorage.setItem("htmlLocal",e)}function a(e){P.srcdoc=e}const I=document.querySelector("#pidemeTextarea"),B=document.querySelector("iframe"),d=document.querySelector(".bot"),M=async(e,s)=>{const n=B.srcdoc;d.classList.add("rootHidden");const c=await(await fetch("./pages/cargando.html")).text();a(c);try{const t={value:e,html:s,gptSelect:localStorage.getItem("gptModel"),tokenGPT:localStorage.getItem("tokenGpt")},o=await fetch(`${E.url}${w.init}`,{method:"POST",headers:{Authorization:`Bearer ${token}`,"Content-Type":"application/json"},body:JSON.stringify(t)});if(!o.ok){const{message:i}=await o.json();throw new Error(i)}const{messageGpt:h,htmlResponse:f,message:r}=await o.json();if(r!=null){a(n),d.classList.remove("rootHidden"),S(r);return}if(f===void 0){a(n),d.classList.remove("rootHidden");return}k(f),a(f),I.value="",d.classList.remove("rootHidden")}catch(t){const{message:o}=t;S(o),d.classList.remove("rootHidden"),a(n)}I.focus()},v=document.querySelector("#pidemeTextarea"),D=document.querySelector(".build"),O=document.querySelector(".reset"),U=document.querySelector(".preview"),z=document.querySelector(".closeSession"),j=document.querySelector("iframe"),b=document.querySelector(".bot"),N=document.querySelector(".download"),V=document.querySelector(".saveTokenGpt"),u=document.querySelector(".tokenGpt"),J=document.querySelector(".buttonMenu"),W=document.querySelector(".menu"),$=document.querySelector(".GptModelSelect");localStorage.setItem("gptModel",$.value);$.addEventListener("change",e=>{localStorage.setItem("gptModel",$.value)});V.addEventListener("click",()=>{if(!u.value.trim()||u.value.trim()===" "){u.focus();return}localStorage.setItem("tokenGpt",u.value),u.value=""});J.addEventListener("click",()=>{W.classList.toggle("menuHidden")});N.addEventListener("click",async()=>{const{separateCode:e}=await C(()=>import("./handleMonacoEditor-c44b2e43.js").then(h=>h.h),["assets/handleMonacoEditor-c44b2e43.js","assets/handleMessageError-8a94c122.js","assets/handleMessageError-a6f1ff3e.css","assets/handleMonacoEditor-1862df68.css"]),{html:s,css:n,js:l}=e(j.srcdoc),c=document.createElement("a"),t=document.createElement("a"),o=document.createElement("a");c.setAttribute("href","data:text/plain;charset=utf-8, "+encodeURIComponent(s)),c.setAttribute("download","index.html"),t.setAttribute("href","data:text/plain;charset=utf-8, "+encodeURIComponent(n)),t.setAttribute("download","style.css"),o.setAttribute("href","data:text/plain;charset=utf-8, "+encodeURIComponent(l)),o.setAttribute("download","script.js"),c.click(),t.click(),o.click()});const x=localStorage.getItem("htmlLocal"),F=async()=>{a('<div  style="width:100vw; height:100vh; display:grid; place-items:center" >cargando...</div>');try{const e=await fetch(`${E.url}${w.showSavedPage}`,{method:"GET",headers:{Authorization:`Bearer ${token}`}});if(!e.ok)return!1;const s=await e.text();k(s),a(s),b.classList.remove("rootHidden")}catch{S("error en la peticion"),b.classList.add("rootHidden")}return!0};x?(a(x),b.classList.remove("rootHidden")):F();v.focus();D.addEventListener("click",()=>{if(v.value===""){v.focus();return}M(v.value,j.srcdoc)});z.addEventListener("click",()=>{localStorage.clear(),window.location.reload()});O.addEventListener("click",async()=>{if(!window.confirm("Esto borrara todo lo creado en la pagina, esta seguro de borrar todo?"))return;const s=localStorage.getItem("token");try{const l=await(await fetch(`${E.url}${w.reset}`,{method:"GET",headers:{Authorization:`Bearer ${s}`}})).json(),{htmlReset:c}=l;a(c),k(c)}catch(n){S(`Error en la conexion.
Mensaje: `+n)}});U.addEventListener("click",async()=>{try{const s=await(await fetch(`${E.url}${w.goBackToPreviusPage}`,{method:"GET",headers:{Authorization:`Bearer ${token}`}})).json(),{html:n}=await s;k(n),a(n)}catch(e){alert(`Error en la conexion.
Mensaje: `+e)}});const m=document.querySelector(".open-close"),q=document.querySelector(".bot");m.addEventListener("click",()=>{q.classList.toggle("close"),q.classList.contains("close")&&(m.classList.remove("bot-open"),m.classList.add("bot-close")),q.classList.contains("close")||(m.classList.remove("bot-close"),m.classList.add("bot-open"))});document.querySelector("#root");document.querySelector(".file");const K=document.querySelector(".openEditor"),Q=document.querySelector(".closeEditorIntern"),y=document.querySelector(".htmlEdit");document.querySelector(".showCode");document.querySelector(".download");const X=document.querySelectorAll(".editorSelect"),L=document.querySelector("#html"),Y=document.querySelector("#css"),Z=document.querySelector("#javascript"),A=document.querySelector("iframe"),ee=document.querySelector("#pidemeTextarea"),T=document.querySelector(".bot"),g={html:L,css:Y,javascript:Z};X.forEach(e=>{e.addEventListener("click",s=>{const l=s.target.className.split(" ")[1].replace("Select","");for(const c in g)c===l?g[c].classList.remove("editHidden"):g[c].classList.contains("editHidden")||g[c].classList.add("editHidden")})});K.addEventListener("click",()=>{A.classList.toggle("anima"),setTimeout(()=>{y.classList.toggle("animaHtmlEdit")},300),y.classList.contains("htmlEditorClosed")&&T.classList.toggle("close"),G(),L.focus()});Q.addEventListener("click",()=>{y.classList.remove("animaHtmlEdit"),setTimeout(()=>{A.classList.toggle("anima"),T.classList.contains("close")&&T.classList.toggle("close"),G()},200),ee.focus()});const G=async()=>{y.classList.toggle("htmlEditorClosed"),L.classList.add("loading");const{showEditor:e}=await C(()=>import("./handleMonacoEditor-c44b2e43.js").then(s=>s.h),["assets/handleMonacoEditor-c44b2e43.js","assets/handleMessageError-8a94c122.js","assets/handleMessageError-a6f1ff3e.css","assets/handleMonacoEditor-1862df68.css"]);e(A.srcdoc),L.classList.remove("loading"),console.log("cargooooo")};export{C as _};
