import{v as p,e as v,s as r}from"./handleMessageError-8a94c122.js";const S=document.querySelector(".switch"),h=document.querySelector(".login-container"),d=document.querySelector(".register-container"),f=document.querySelector(".login-container > input[type='submit']"),b=document.querySelector(".register-container > input[type='submit']"),y=document.querySelector(".login-container  input[name='username']"),a=document.querySelector(".login-container  input[name='password']"),c=document.querySelector(".register-container > input[name='username']"),n=document.querySelector(".register-container  input[name='password']"),o=document.querySelector(".register-container  input[name='repeat-password']"),s=document.querySelector(".loading"),q=document.querySelector(".showPasswordLogin"),k=document.querySelector(".showPasswordRegister"),R=document.querySelector(".showPasswordRepeatRegister");a.addEventListener("keyup",e=>{e.key==="Enter"&&u(y.value,a.value)});q.addEventListener("click",()=>{l(a)});k.addEventListener("click",()=>{l(n)});R.addEventListener("click",()=>{l(o)});const l=e=>{e.getAttribute("type")==="password"?e.setAttribute("type","text"):e.setAttribute("type","password")};S.addEventListener("click",()=>{d.classList.contains("hidden-register")?(h.classList.toggle("hidden-login"),setTimeout(()=>{d.classList.toggle("hidden-register")},300)):(d.classList.toggle("hidden-register"),setTimeout(()=>{h.classList.toggle("hidden-login")},300))});f.addEventListener("click",e=>{e.preventDefault(),u(y.value,a.value)});const u=async(e,t)=>{if(!e||!t){alert("faltan datos");return}s.classList.add("loading-show"),s.classList.remove("loading-hidden");const i={username:e,password:t};try{localStorage.clear();const m=await(await fetch(`${p.url}${v.login}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json(),{token:w}=m;if(!w){const{message:L}=m;r(L),s.classList.remove("loading-show"),s.classList.add("loading-hidden");return}localStorage.setItem("token",w),window.location.href="/index.html"}catch(g){s.classList.remove("loading-show"),s.classList.add("loading-hidden"),r(`error en el servidor
`+g.message)}};b.addEventListener("click",e=>{e.preventDefault(),E()});const E=async()=>{if(!(!c.value||!n.value||!o.value)){if(!P(n.value,o.value)){alert("las contraseÃ±as no coinciden");return}try{s.classList.add("loading-show"),s.classList.remove("loading-hidden");const e={username:c.value,password:n.value},t=await fetch(`${p.url}${v.register}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const i=await t.text();s.classList.remove("loading-show"),s.classList.add("loading-hidden"),r(i);return}s.classList.remove("loading-show"),s.classList.add("loading-hidden"),u(c.value,n.value)}catch(e){s.classList.remove("loading-show"),s.classList.add("loading-hidden"),r(`error en el servidor
`+e.message)}}};o.addEventListener("input",e=>{n.value!=o.value?o.style.backgroundColor="rgba(255, 114, 114,.5)":o.style.backgroundColor="rgb(255, 255, 255)"});const P=(e,t)=>e===t;
