import{v,s as k}from"./handleMessageError-e012e9f7.js";const C="modulepreload",j=function(e){return"/"+e},b={},I=function(n,r,l){if(!r||r.length===0)return n();const s=document.getElementsByTagName("link");return Promise.all(r.map(t=>{if(t=j(t),t in b)return;b[t]=!0;const o=t.endsWith(".css"),m=o?'[rel="stylesheet"]':"";if(!!l)for(let i=s.length-1;i>=0;i--){const g=s[i];if(g.href===t&&(!o||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${t}"]${m}`))return;const a=document.createElement("link");if(a.rel=o?"stylesheet":C,o||(a.as="script",a.crossOrigin=""),a.href=t,document.head.appendChild(a),o)return new Promise((i,g)=>{a.addEventListener("load",i),a.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${t}`)))})})).then(()=>n()).catch(t=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=t,window.dispatchEvent(o),!o.defaultPrevented)throw t})},G=document.querySelector("iframe");function y(e){localStorage.setItem("htmlLocal",e)}function c(e){G.srcdoc=e}const T=document.querySelector("#pidemeTextarea"),R=document.querySelector("iframe"),d=document.querySelector(".bot"),_=async(e,n)=>{const r=R.srcdoc;d.classList.add("rootHidden");const s=await(await fetch("./pages/cargando.html")).text();c(s);try{if(!localStorage.getItem("tokenGpt")){console.log("error"),alert("ingresa un token valido de OpenIa"),d.classList.remove("rootHidden"),c(r);return}const t={value:e,html:n,gptSelect:localStorage.getItem("gptModel"),token:localStorage.getItem("tokenGpt")},o=await fetch(`${v.url}`,{method:"POST",headers:{Authorization:`Bearer ${token}`,"Content-Type":"application/json"},body:JSON.stringify(t)});if(!o.ok){const{message:a}=await o.json();throw new Error(a)}const{messageGpt:m,htmlResponse:h}=await o.json();if(h===void 0){c(r),d.classList.remove("rootHidden"),localStorage.clear(),location.reload();return}y(h),c(h),T.value="",d.classList.remove("rootHidden")}catch(t){const{message:o}=t;k(o+", error en el servidor"),d.classList.remove("rootHidden"),c(r)}T.focus()},p=document.querySelector("#pidemeTextarea"),P=document.querySelector(".build"),B=document.querySelector(".reset"),M=document.querySelector(".preview"),D=document.querySelector(".closeSession"),A=document.querySelector("iframe"),E=document.querySelector(".bot"),O=document.querySelector(".download"),U=document.querySelector(".saveTokenGpt"),u=document.querySelector(".tokenGpt"),z=document.querySelector(".buttonMenu"),N=document.querySelector(".menu"),w=document.querySelector(".GptModelSelect");localStorage.setItem("gptModel",w.value);w.addEventListener("change",e=>{localStorage.setItem("gptModel",w.value)});U.addEventListener("click",()=>{if(!u.value.trim()||u.value.trim()===" "){u.focus();return}localStorage.setItem("tokenGpt",u.value),u.value=""});z.addEventListener("click",()=>{N.classList.toggle("menuHidden")});O.addEventListener("click",async()=>{const{separateCode:e}=await I(()=>import("./handleMonacoEditor-5d7acd57.js").then(m=>m.h),["assets/handleMonacoEditor-5d7acd57.js","assets/handleMessageError-e012e9f7.js","assets/handleMessageError-a6f1ff3e.css","assets/handleMonacoEditor-1862df68.css"]),{html:n,css:r,js:l}=e(A.srcdoc),s=document.createElement("a"),t=document.createElement("a"),o=document.createElement("a");s.setAttribute("href","data:text/plain;charset=utf-8, "+encodeURIComponent(n)),s.setAttribute("download","index.html"),t.setAttribute("href","data:text/plain;charset=utf-8, "+encodeURIComponent(r)),t.setAttribute("download","style.css"),o.setAttribute("href","data:text/plain;charset=utf-8, "+encodeURIComponent(l)),o.setAttribute("download","script.js"),s.click(),t.click(),o.click()});const $=localStorage.getItem("htmlLocal"),V=async()=>{c('<div  style="width:100vw; height:100vh; display:grid; place-items:center" >cargando...</div>');try{const e=await fetch(`${v.url}/showSavedPage`,{method:"GET",headers:{Authorization:`Bearer ${token}`}});if(!e.ok)return!1;const n=await e.text();y(n),c(n),E.classList.remove("rootHidden")}catch{k("error en la peticion"),E.classList.add("rootHidden")}return!0};$?(c($),E.classList.remove("rootHidden")):V();p.focus();P.addEventListener("click",()=>{if(p.value===""){p.focus();return}_(p.value,A.srcdoc)});D.addEventListener("click",()=>{localStorage.clear(),window.location.reload()});B.addEventListener("click",async()=>{if(!window.confirm("Esto borrara todo lo creado en la pagina, esta seguro de borrar todo?"))return;const n=localStorage.getItem("token");try{const r=await fetch(`${v.url}/reset`,{method:"GET",headers:{Authorization:`Bearer ${n}`}});console.log(n);const l=await r.json(),{htmlReset:s}=l;c(s),y(s),console.log(s)}catch(r){k(`Error en la conexion.
Mensaje: `+r)}});M.addEventListener("click",async()=>{try{const n=await(await fetch(`${v.url}/goBackToPreviusPage`,{method:"GET",headers:{Authorization:`Bearer ${token}`}})).json(),{html:r}=await n;y(r),c(r)}catch(e){alert(`Error en la conexion.
Mensaje: `+e)}});const J=document.querySelector(".open-close"),W=document.querySelector(".bot");J.addEventListener("click",()=>{W.classList.toggle("close")});document.querySelector("#root");document.querySelector(".file");const F=document.querySelector(".openEditor"),K=document.querySelector(".closeEditorIntern"),S=document.querySelector(".htmlEdit");document.querySelector(".showCode");document.querySelector(".download");const Q=document.querySelectorAll(".editorSelect"),H=document.querySelector("#html"),X=document.querySelector("#css"),Y=document.querySelector("#javascript"),q=document.querySelector("iframe"),Z=document.querySelector("#pidemeTextarea"),L=document.querySelector(".bot"),f={html:H,css:X,javascript:Y};Q.forEach(e=>{e.addEventListener("click",n=>{const l=n.target.className.split(" ")[1].replace("Select","");for(const s in f)s===l?f[s].classList.remove("editHidden"):f[s].classList.contains("editHidden")||f[s].classList.add("editHidden")})});F.addEventListener("click",()=>{q.classList.toggle("anima"),setTimeout(()=>{S.classList.toggle("animaHtmlEdit")},300),S.classList.contains("htmlEditorClosed")&&L.classList.toggle("close"),x(),H.focus()});K.addEventListener("click",()=>{S.classList.remove("animaHtmlEdit"),setTimeout(()=>{q.classList.toggle("anima"),L.classList.contains("close")&&L.classList.toggle("close"),x()},200),Z.focus()});const x=async()=>{S.classList.toggle("htmlEditorClosed");const{showEditor:e}=await I(()=>import("./handleMonacoEditor-5d7acd57.js").then(n=>n.h),["assets/handleMonacoEditor-5d7acd57.js","assets/handleMessageError-e012e9f7.js","assets/handleMessageError-a6f1ff3e.css","assets/handleMonacoEditor-1862df68.css"]);e(q.srcdoc)};export{I as _};
