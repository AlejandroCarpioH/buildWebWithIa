import{v as y,e as E,s as S}from"./handleMessageError-8a94c122.js";const j="modulepreload",G=function(e){return"/"+e},$={},H=function(n,s,l){if(!s||s.length===0)return n();const r=document.getElementsByTagName("link");return Promise.all(s.map(t=>{if(t=G(t),t in $)return;$[t]=!0;const o=t.endsWith(".css"),m=o?'[rel="stylesheet"]':"";if(!!l)for(let i=r.length-1;i>=0;i--){const f=r[i];if(f.href===t&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${t}"]${m}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":j,o||(c.as="script",c.crossOrigin=""),c.href=t,document.head.appendChild(c),o)return new Promise((i,f)=>{c.addEventListener("load",i),c.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${t}`)))})})).then(()=>n()).catch(t=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=t,window.dispatchEvent(o),!o.defaultPrevented)throw t})},R=document.querySelector("iframe");function w(e){localStorage.setItem("htmlLocal",e)}function a(e){R.srcdoc=e}const T=document.querySelector("#pidemeTextarea"),_=document.querySelector("iframe"),d=document.querySelector(".bot"),P=async(e,n)=>{const s=_.srcdoc;d.classList.add("rootHidden");const r=await(await fetch("./pages/cargando.html")).text();a(r);try{const t={value:e,html:n,gptSelect:localStorage.getItem("gptModel"),tokenGPT:localStorage.getItem("tokenGpt")},o=await fetch(`${y.url}${E.init}`,{method:"POST",headers:{Authorization:`Bearer ${token}`,"Content-Type":"application/json"},body:JSON.stringify(t)});if(!o.ok){const{message:i}=await o.json();throw new Error(i)}const{messageGpt:m,htmlResponse:h,message:c}=await o.json();if(console.log(c),c!=null){a(s),d.classList.remove("rootHidden"),S(c);return}if(h===void 0){a(s),d.classList.remove("rootHidden");return}w(h),a(h),T.value="",d.classList.remove("rootHidden")}catch(t){const{message:o}=t;S(o),d.classList.remove("rootHidden"),a(s)}T.focus()},g=document.querySelector("#pidemeTextarea"),B=document.querySelector(".build"),M=document.querySelector(".reset"),D=document.querySelector(".preview"),O=document.querySelector(".closeSession"),I=document.querySelector("iframe"),L=document.querySelector(".bot"),U=document.querySelector(".download"),z=document.querySelector(".saveTokenGpt"),u=document.querySelector(".tokenGpt"),N=document.querySelector(".buttonMenu"),V=document.querySelector(".menu"),k=document.querySelector(".GptModelSelect");localStorage.setItem("gptModel",k.value);k.addEventListener("change",e=>{localStorage.setItem("gptModel",k.value)});z.addEventListener("click",()=>{if(!u.value.trim()||u.value.trim()===" "){u.focus();return}localStorage.setItem("tokenGpt",u.value),u.value=""});N.addEventListener("click",()=>{V.classList.toggle("menuHidden")});U.addEventListener("click",async()=>{const{separateCode:e}=await H(()=>import("./handleMonacoEditor-19547a1f.js").then(m=>m.h),["assets/handleMonacoEditor-19547a1f.js","assets/handleMessageError-8a94c122.js","assets/handleMessageError-a6f1ff3e.css","assets/handleMonacoEditor-1862df68.css"]),{html:n,css:s,js:l}=e(I.srcdoc),r=document.createElement("a"),t=document.createElement("a"),o=document.createElement("a");r.setAttribute("href","data:text/plain;charset=utf-8, "+encodeURIComponent(n)),r.setAttribute("download","index.html"),t.setAttribute("href","data:text/plain;charset=utf-8, "+encodeURIComponent(s)),t.setAttribute("download","style.css"),o.setAttribute("href","data:text/plain;charset=utf-8, "+encodeURIComponent(l)),o.setAttribute("download","script.js"),r.click(),t.click(),o.click()});const A=localStorage.getItem("htmlLocal"),J=async()=>{a('<div  style="width:100vw; height:100vh; display:grid; place-items:center" >cargando...</div>');try{const e=await fetch(`${y.url}${E.showSavedPage}`,{method:"GET",headers:{Authorization:`Bearer ${token}`}});if(!e.ok)return!1;const n=await e.text();w(n),a(n),L.classList.remove("rootHidden")}catch{S("error en la peticion"),L.classList.add("rootHidden")}return!0};A?(a(A),L.classList.remove("rootHidden")):J();g.focus();B.addEventListener("click",()=>{if(g.value===""){g.focus();return}P(g.value,I.srcdoc)});O.addEventListener("click",()=>{localStorage.clear(),window.location.reload()});M.addEventListener("click",async()=>{if(!window.confirm("Esto borrara todo lo creado en la pagina, esta seguro de borrar todo?"))return;const n=localStorage.getItem("token");try{const l=await(await fetch(`${y.url}${E.reset}`,{method:"GET",headers:{Authorization:`Bearer ${n}`}})).json(),{htmlReset:r}=l;a(r),w(r)}catch(s){S(`Error en la conexion.
Mensaje: `+s)}});D.addEventListener("click",async()=>{try{const n=await(await fetch(`${y.url}${E.goBackToPreviusPage}`,{method:"GET",headers:{Authorization:`Bearer ${token}`}})).json(),{html:s}=await n;w(s),a(s)}catch(e){alert(`Error en la conexion.
Mensaje: `+e)}});const W=document.querySelector(".open-close"),F=document.querySelector(".bot");W.addEventListener("click",()=>{F.classList.toggle("close")});document.querySelector("#root");document.querySelector(".file");const K=document.querySelector(".openEditor"),Q=document.querySelector(".closeEditorIntern"),v=document.querySelector(".htmlEdit");document.querySelector(".showCode");document.querySelector(".download");const X=document.querySelectorAll(".editorSelect"),x=document.querySelector("#html"),Y=document.querySelector("#css"),Z=document.querySelector("#javascript"),b=document.querySelector("iframe"),ee=document.querySelector("#pidemeTextarea"),q=document.querySelector(".bot"),p={html:x,css:Y,javascript:Z};X.forEach(e=>{e.addEventListener("click",n=>{const l=n.target.className.split(" ")[1].replace("Select","");for(const r in p)r===l?p[r].classList.remove("editHidden"):p[r].classList.contains("editHidden")||p[r].classList.add("editHidden")})});K.addEventListener("click",()=>{b.classList.toggle("anima"),setTimeout(()=>{v.classList.toggle("animaHtmlEdit")},300),v.classList.contains("htmlEditorClosed")&&q.classList.toggle("close"),C(),x.focus()});Q.addEventListener("click",()=>{v.classList.remove("animaHtmlEdit"),setTimeout(()=>{b.classList.toggle("anima"),q.classList.contains("close")&&q.classList.toggle("close"),C()},200),ee.focus()});const C=async()=>{v.classList.toggle("htmlEditorClosed");const{showEditor:e}=await H(()=>import("./handleMonacoEditor-19547a1f.js").then(n=>n.h),["assets/handleMonacoEditor-19547a1f.js","assets/handleMessageError-8a94c122.js","assets/handleMessageError-a6f1ff3e.css","assets/handleMonacoEditor-1862df68.css"]);e(b.srcdoc)};export{H as _};
